[
  {
    "test_id": 1,
    "question": "统计总共有多少个客户",
    "difficulty": "easy",
    "direct": {
      "success": true,
      "sql": "SELECT COUNT(*) AS total_customers FROM customers;",
      "row_count": 1,
      "time": 0.672382116317749,
      "attempts": 1
    },
    "exploratory": {
      "success": false,
      "error": "无法生成有效的SQL",
      "attempts": []
    }
  },
  {
    "test_id": 2,
    "question": "找出VIP等级为3（钻石会员）的所有客户",
    "difficulty": "easy",
    "direct": {
      "success": true,
      "sql": "SELECT * FROM customers WHERE vip_level = 3;",
      "row_count": 2,
      "time": 1.1162910461425781,
      "attempts": 1
    },
    "exploratory": {
      "success": false,
      "error": "无法生成有效的SQL",
      "attempts": []
    }
  },
  {
    "test_id": 3,
    "question": "哪个城市的客户平均消费金额最高？",
    "difficulty": "medium",
    "direct": {
      "success": true,
      "sql": "SELECT c.city, AVG(o.total_amount) AS average_spending FROM customers c JOIN orders o ON c.id = o.customer_id GROUP BY c.city ORDER BY average_spending DESC LIMIT 1;",
      "row_count": 1,
      "time": 2.006767988204956,
      "attempts": 1
    },
    "exploratory": {
      "success": false,
      "error": "无法生成有效的SQL",
      "attempts": [
        {
          "attempt": 4,
          "sql": "SELECT c.city, AVG(o.total_amount) AS average_spent",
          "success": false,
          "error": "missing FROM-clause entry for table \"c\"\nLINE 1: SELECT c.city, AVG(o.total_amount) AS average_spent\n               ^\n"
        }
      ]
    }
  },
  {
    "test_id": 4,
    "question": "找出订单金额最大的前3个客户的姓名和总消费",
    "difficulty": "medium",
    "direct": {
      "success": true,
      "sql": "SELECT c.name, SUM(o.total_amount) AS total_spent FROM customers c JOIN orders o ON c.id = o.customer_id GROUP BY c.id, c.name ORDER BY total_spent DESC LIMIT 3;",
      "row_count": 3,
      "time": 1.9798641204833984,
      "attempts": 1
    },
    "exploratory": {
      "success": false,
      "error": "无法生成有效的SQL",
      "attempts": []
    }
  },
  {
    "test_id": 5,
    "question": "统计每个产品类别的销售数量和销售总额",
    "difficulty": "hard",
    "direct": {
      "success": true,
      "sql": "SELECT pc.name AS category_name, SUM(oi.quantity) AS total_quantity_sold, SUM(oi.quantity * oi.unit_price) AS total_sales_amount FROM product_categories pc JOIN products p ON pc.id = p.category_id JOIN order_items oi ON p.id = oi.product_id GROUP BY pc.name;",
      "row_count": 7,
      "time": 2.662585735321045,
      "attempts": 1
    },
    "exploratory": {
      "success": false,
      "error": "无法生成有效的SQL",
      "attempts": []
    }
  },
  {
    "test_id": 6,
    "question": "找出评价数量最多但平均评分低于4的产品",
    "difficulty": "hard",
    "direct": {
      "success": true,
      "sql": "SELECT p.id, p.name FROM products p JOIN product_reviews pr ON p.id = pr.product_id GROUP BY p.id, p.name ORDER BY COUNT(pr.id) DESC, AVG(pr.rating) ASC LIMIT 1;",
      "row_count": 1,
      "time": 1.9778921604156494,
      "attempts": 1
    },
    "exploratory": {
      "success": false,
      "error": "无法生成有效的SQL",
      "attempts": []
    }
  }
]