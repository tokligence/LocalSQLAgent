[
  {
    "question": "\u67e5\u8be2\u6240\u6709\u7528\u6237\u7684\u540d\u5b57\u548c\u90ae\u7bb1",
    "query_type": "find",
    "difficulty": "simple",
    "gold_query": "db.users.find({}, {\"name\": 1, \"email\": 1, \"_id\": 0})",
    "pred_query": "db.users.find({}, {\"name\": 1, \"email\": 1})",
    "execution_match": false,
    "gold_result": [
      {
        "name": "Alice",
        "email": "alice@example.com"
      },
      {
        "name": "Bob",
        "email": "bob@example.com"
      },
      {
        "name": "Charlie",
        "email": "charlie@example.com"
      },
      {
        "name": "Diana",
        "email": "diana@example.com"
      },
      {
        "name": "Eve",
        "email": "eve@example.com"
      },
      {
        "name": "Frank",
        "email": "frank@example.com"
      },
      {
        "name": "Grace",
        "email": "grace@example.com"
      },
      {
        "name": "Henry",
        "email": "henry@example.com"
      },
      {
        "name": "Ivy",
        "email": "ivy@example.com"
      },
      {
        "name": "Jack",
        "email": "jack@example.com"
      }
    ],
    "pred_result": [
      {
        "_id": 1,
        "name": "Alice",
        "email": "alice@example.com"
      },
      {
        "_id": 2,
        "name": "Bob",
        "email": "bob@example.com"
      },
      {
        "_id": 3,
        "name": "Charlie",
        "email": "charlie@example.com"
      },
      {
        "_id": 4,
        "name": "Diana",
        "email": "diana@example.com"
      },
      {
        "_id": 5,
        "name": "Eve",
        "email": "eve@example.com"
      },
      {
        "_id": 6,
        "name": "Frank",
        "email": "frank@example.com"
      },
      {
        "_id": 7,
        "name": "Grace",
        "email": "grace@example.com"
      },
      {
        "_id": 8,
        "name": "Henry",
        "email": "henry@example.com"
      },
      {
        "_id": 9,
        "name": "Ivy",
        "email": "ivy@example.com"
      },
      {
        "_id": 10,
        "name": "Jack",
        "email": "jack@example.com"
      }
    ],
    "error": null,
    "latency": 1.1744067668914795,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u627e\u51fa\u5e74\u9f84\u5927\u4e8e30\u5c81\u7684\u7528\u6237",
    "query_type": "find",
    "difficulty": "simple",
    "gold_query": "db.users.find({\"age\": {\"$gt\": 30}})",
    "pred_query": "db.users.find({\"age\": {\"$gt\": 30}})",
    "execution_match": true,
    "gold_result": [
      {
        "_id": 2,
        "name": "Bob",
        "email": "bob@example.com",
        "age": 35,
        "department_id": 1,
        "salary": 95000,
        "created_at": "2024-01-02 00:00:00"
      },
      {
        "_id": 3,
        "name": "Charlie",
        "email": "charlie@example.com",
        "age": 42,
        "department_id": 2,
        "salary": 85000,
        "created_at": "2024-01-03 00:00:00"
      },
      {
        "_id": 4,
        "name": "Diana",
        "email": "diana@example.com",
        "age": 31,
        "department_id": 2,
        "salary": 72000,
        "created_at": "2024-01-04 00:00:00"
      },
      {
        "_id": 6,
        "name": "Frank",
        "email": "frank@example.com",
        "age": 45,
        "department_id": 1,
        "salary": 120000,
        "created_at": "2024-01-06 00:00:00"
      },
      {
        "_id": 8,
        "name": "Henry",
        "email": "henry@example.com",
        "age": 38,
        "department_id": 2,
        "salary": 90000,
        "created_at": "2024-01-08 00:00:00"
      },
      {
        "_id": 10,
        "name": "Jack",
        "email": "jack@example.com",
        "age": 33,
        "department_id": 1,
        "salary": 88000,
        "created_at": "2024-01-10 00:00:00"
      }
    ],
    "pred_result": [
      {
        "_id": 2,
        "name": "Bob",
        "email": "bob@example.com",
        "age": 35,
        "department_id": 1,
        "salary": 95000,
        "created_at": "2024-01-02 00:00:00"
      },
      {
        "_id": 3,
        "name": "Charlie",
        "email": "charlie@example.com",
        "age": 42,
        "department_id": 2,
        "salary": 85000,
        "created_at": "2024-01-03 00:00:00"
      },
      {
        "_id": 4,
        "name": "Diana",
        "email": "diana@example.com",
        "age": 31,
        "department_id": 2,
        "salary": 72000,
        "created_at": "2024-01-04 00:00:00"
      },
      {
        "_id": 6,
        "name": "Frank",
        "email": "frank@example.com",
        "age": 45,
        "department_id": 1,
        "salary": 120000,
        "created_at": "2024-01-06 00:00:00"
      },
      {
        "_id": 8,
        "name": "Henry",
        "email": "henry@example.com",
        "age": 38,
        "department_id": 2,
        "salary": 90000,
        "created_at": "2024-01-08 00:00:00"
      },
      {
        "_id": 10,
        "name": "Jack",
        "email": "jack@example.com",
        "age": 33,
        "department_id": 1,
        "salary": 88000,
        "created_at": "2024-01-10 00:00:00"
      }
    ],
    "error": null,
    "latency": 0.8755538463592529,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u67e5\u8be2Engineering\u90e8\u95e8\u7684\u6240\u6709\u5458\u5de5",
    "query_type": "find",
    "difficulty": "simple",
    "gold_query": "db.users.find({\"department_id\": 1})",
    "pred_query": "db.users.find({\"department_id\": \"Engineering\"})",
    "execution_match": false,
    "gold_result": [
      {
        "_id": 1,
        "name": "Alice",
        "email": "alice@example.com",
        "age": 28,
        "department_id": 1,
        "salary": 75000,
        "created_at": "2024-01-01 00:00:00"
      },
      {
        "_id": 2,
        "name": "Bob",
        "email": "bob@example.com",
        "age": 35,
        "department_id": 1,
        "salary": 95000,
        "created_at": "2024-01-02 00:00:00"
      },
      {
        "_id": 6,
        "name": "Frank",
        "email": "frank@example.com",
        "age": 45,
        "department_id": 1,
        "salary": 120000,
        "created_at": "2024-01-06 00:00:00"
      },
      {
        "_id": 10,
        "name": "Jack",
        "email": "jack@example.com",
        "age": 33,
        "department_id": 1,
        "salary": 88000,
        "created_at": "2024-01-10 00:00:00"
      }
    ],
    "pred_result": [],
    "error": null,
    "latency": 0.7682089805603027,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u7edf\u8ba1\u7528\u6237\u603b\u6570",
    "query_type": "aggregate",
    "difficulty": "medium",
    "gold_query": "db.users.aggregate([{\"$count\": \"total\"}])",
    "pred_query": "db.users.count_documents({})",
    "execution_match": false,
    "gold_result": [
      {
        "total": 10
      }
    ],
    "pred_result": null,
    "error": "'int' object is not iterable",
    "latency": 0.6439208984375,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u8ba1\u7b97\u6240\u6709\u8ba2\u5355\u7684\u603b\u91d1\u989d",
    "query_type": "aggregate",
    "difficulty": "medium",
    "gold_query": "db.orders.aggregate([{\"$group\": {\"_id\": null, \"total\": {\"$sum\": \"$amount\"}}}])",
    "pred_query": "db.orders.aggregate([\n    {\n        \"$group\": {\n            \"_id\": None,\n            \"total_amount\": {\"$sum\": \"$amount\"}\n        }\n    }\n])",
    "execution_match": false,
    "gold_result": null,
    "pred_result": [
      {
        "_id": null,
        "total_amount": 7029.849999999999
      }
    ],
    "error": null,
    "latency": 1.3823940753936768,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u7edf\u8ba1\u6bcf\u4e2a\u90e8\u95e8\u7684\u5458\u5de5\u6570\u91cf",
    "query_type": "aggregate",
    "difficulty": "medium",
    "gold_query": "db.users.aggregate([{\"$group\": {\"_id\": \"$department_id\", \"count\": {\"$sum\": 1}}}])",
    "pred_query": "db.departments.aggregate([\n    {\n        \"$lookup\": {\n            \"from\": \"users\",\n            \"localField\": \"_id\",\n            \"foreignField\": \"department_id\",\n            \"as\": \"employees\"\n        }\n    },\n    {\n        \"$project\": {\n            \"_id\": 1,\n            \"name\": 1,\n            \"budget\": 1,\n            \"employee_count\": {\"$size\": \"$employees\"}\n        }\n    }\n])",
    "execution_match": false,
    "gold_result": [
      {
        "_id": 1,
        "count": 4
      },
      {
        "_id": 4,
        "count": 1
      },
      {
        "_id": 2,
        "count": 3
      },
      {
        "_id": 3,
        "count": 2
      }
    ],
    "pred_result": [
      {
        "_id": 1,
        "name": "Engineering",
        "budget": 500000,
        "employee_count": 4
      },
      {
        "_id": 2,
        "name": "Sales",
        "budget": 300000,
        "employee_count": 3
      },
      {
        "_id": 3,
        "name": "Marketing",
        "budget": 200000,
        "employee_count": 2
      },
      {
        "_id": 4,
        "name": "HR",
        "budget": 100000,
        "employee_count": 1
      }
    ],
    "error": null,
    "latency": 2.8398261070251465,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u627e\u51fa\u85aa\u8d44\u6700\u9ad8\u7684\u524d3\u540d\u5458\u5de5",
    "query_type": "find",
    "difficulty": "medium",
    "gold_query": "db.users.find().sort({\"salary\": -1}).limit(3)",
    "pred_query": "db.users.find({}).sort({\"salary\": -1}).limit(3)",
    "execution_match": true,
    "gold_result": [
      {
        "_id": 6,
        "name": "Frank",
        "email": "frank@example.com",
        "age": 45,
        "department_id": 1,
        "salary": 120000,
        "created_at": "2024-01-06 00:00:00"
      },
      {
        "_id": 2,
        "name": "Bob",
        "email": "bob@example.com",
        "age": 35,
        "department_id": 1,
        "salary": 95000,
        "created_at": "2024-01-02 00:00:00"
      },
      {
        "_id": 8,
        "name": "Henry",
        "email": "henry@example.com",
        "age": 38,
        "department_id": 2,
        "salary": 90000,
        "created_at": "2024-01-08 00:00:00"
      }
    ],
    "pred_result": [
      {
        "_id": 6,
        "name": "Frank",
        "email": "frank@example.com",
        "age": 45,
        "department_id": 1,
        "salary": 120000,
        "created_at": "2024-01-06 00:00:00"
      },
      {
        "_id": 2,
        "name": "Bob",
        "email": "bob@example.com",
        "age": 35,
        "department_id": 1,
        "salary": 95000,
        "created_at": "2024-01-02 00:00:00"
      },
      {
        "_id": 8,
        "name": "Henry",
        "email": "henry@example.com",
        "age": 38,
        "department_id": 2,
        "salary": 90000,
        "created_at": "2024-01-08 00:00:00"
      }
    ],
    "error": null,
    "latency": 0.9208481311798096,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u67e5\u8be2\u6bcf\u4e2a\u7528\u6237\u7684\u8ba2\u5355\u603b\u6570\u548c\u603b\u91d1\u989d",
    "query_type": "aggregate",
    "difficulty": "complex",
    "gold_query": "db.users.aggregate([\n            {\"$lookup\": {\"from\": \"orders\", \"localField\": \"_id\", \"foreignField\": \"user_id\", \"as\": \"orders\"}},\n            {\"$project\": {\n                \"name\": 1,\n                \"order_count\": {\"$size\": \"$orders\"},\n                \"total_amount\": {\"$sum\": \"$orders.amount\"}\n            }}\n        ])",
    "pred_query": "db.orders.aggregate([\n    {\n        \"$group\": {\n            \"_id\": \"$user_id\",\n            \"total_orders\": {\"$sum\": 1},\n            \"total_amount\": {\"$sum\": \"$amount\"}\n        }\n    }\n])",
    "execution_match": false,
    "gold_result": [
      {
        "_id": 1,
        "name": "Alice",
        "order_count": 3,
        "total_amount": 1819.96
      },
      {
        "_id": 2,
        "name": "Bob",
        "order_count": 2,
        "total_amount": 1049.97
      },
      {
        "_id": 3,
        "name": "Charlie",
        "order_count": 2,
        "total_amount": 279.98
      },
      {
        "_id": 4,
        "name": "Diana",
        "order_count": 1,
        "total_amount": 1699.98
      },
      {
        "_id": 5,
        "name": "Eve",
        "order_count": 1,
        "total_amount": 79.99
      },
      {
        "_id": 6,
        "name": "Frank",
        "order_count": 1,
        "total_amount": 2099.97
      },
      {
        "_id": 7,
        "name": "Grace",
        "order_count": 0,
        "total_amount": 0
      },
      {
        "_id": 8,
        "name": "Henry",
        "order_count": 0,
        "total_amount": 0
      },
      {
        "_id": 9,
        "name": "Ivy",
        "order_count": 0,
        "total_amount": 0
      },
      {
        "_id": 10,
        "name": "Jack",
        "order_count": 0,
        "total_amount": 0
      }
    ],
    "pred_result": [
      {
        "_id": 2,
        "total_orders": 2,
        "total_amount": 1049.97
      },
      {
        "_id": 3,
        "total_orders": 2,
        "total_amount": 279.98
      },
      {
        "_id": 5,
        "total_orders": 1,
        "total_amount": 79.99
      },
      {
        "_id": 1,
        "total_orders": 3,
        "total_amount": 1819.96
      },
      {
        "_id": 4,
        "total_orders": 1,
        "total_amount": 1699.98
      },
      {
        "_id": 6,
        "total_orders": 1,
        "total_amount": 2099.97
      }
    ],
    "error": null,
    "latency": 1.7406232357025146,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u627e\u51fa\u8d2d\u4e70\u8fc7Electronics\u7c7b\u4ea7\u54c1\u7684\u7528\u6237",
    "query_type": "aggregate",
    "difficulty": "complex",
    "gold_query": "db.orders.aggregate([\n            {\"$lookup\": {\"from\": \"products\", \"localField\": \"items.product_id\", \"foreignField\": \"_id\", \"as\": \"products\"}},\n            {\"$match\": {\"products.category\": \"Electronics\"}},\n            {\"$lookup\": {\"from\": \"users\", \"localField\": \"user_id\", \"foreignField\": \"_id\", \"as\": \"user\"}},\n            {\"$unwind\": \"$user\"},\n            {\"$project\": {\"user.name\": 1, \"user.email\": 1}},\n            {\"$group\": {\"_id\": \"$user\"}}\n        ])",
    "pred_query": "db.orders.aggregate([\n    {\n        \"$unwind\": \"$items\"\n    },\n    {\n        \"$lookup\": {\n            \"from\": \"products\",\n            \"localField\": \"items.product_id\",\n            \"foreignField\": \"_id\",\n            \"as\": \"product_info\"\n        }\n    },\n    {\n        \"$match\": {\n            \"product_info.category\": \"Electronics\"\n        }\n    },\n    {\n        \"$group\": {\n            \"_id\": \"$user_id\",\n            \"user_ids\": {\"$addToSet\": \"$user_id\"}\n        }\n    },\n    {\n        \"$lookup\": {\n            \"from\": \"users\",\n            \"localField\": \"user_ids\",\n            \"foreignField\": \"_id\",\n            \"as\": \"user_details\"\n        }\n    },\n    {\n        \"$project\": {\n            \"_id\": 0,\n            \"user_details\": 1\n        }\n    }\n])",
    "execution_match": false,
    "gold_result": [
      {
        "_id": {
          "name": "Eve",
          "email": "eve@example.com"
        }
      },
      {
        "_id": {
          "name": "Bob",
          "email": "bob@example.com"
        }
      },
      {
        "_id": {
          "name": "Alice",
          "email": "alice@example.com"
        }
      },
      {
        "_id": {
          "name": "Frank",
          "email": "frank@example.com"
        }
      },
      {
        "_id": {
          "name": "Charlie",
          "email": "charlie@example.com"
        }
      },
      {
        "_id": {
          "name": "Diana",
          "email": "diana@example.com"
        }
      }
    ],
    "pred_result": [
      {
        "user_details": [
          {
            "_id": 4,
            "name": "Diana",
            "email": "diana@example.com",
            "age": 31,
            "department_id": 2,
            "salary": 72000,
            "created_at": "2024-01-04 00:00:00"
          }
        ]
      },
      {
        "user_details": [
          {
            "_id": 5,
            "name": "Eve",
            "email": "eve@example.com",
            "age": 26,
            "department_id": 3,
            "salary": 65000,
            "created_at": "2024-01-05 00:00:00"
          }
        ]
      },
      {
        "user_details": [
          {
            "_id": 1,
            "name": "Alice",
            "email": "alice@example.com",
            "age": 28,
            "department_id": 1,
            "salary": 75000,
            "created_at": "2024-01-01 00:00:00"
          }
        ]
      },
      {
        "user_details": [
          {
            "_id": 2,
            "name": "Bob",
            "email": "bob@example.com",
            "age": 35,
            "department_id": 1,
            "salary": 95000,
            "created_at": "2024-01-02 00:00:00"
          }
        ]
      },
      {
        "user_details": [
          {
            "_id": 6,
            "name": "Frank",
            "email": "frank@example.com",
            "age": 45,
            "department_id": 1,
            "salary": 120000,
            "created_at": "2024-01-06 00:00:00"
          }
        ]
      },
      {
        "user_details": [
          {
            "_id": 3,
            "name": "Charlie",
            "email": "charlie@example.com",
            "age": 42,
            "department_id": 2,
            "salary": 85000,
            "created_at": "2024-01-03 00:00:00"
          }
        ]
      }
    ],
    "error": null,
    "latency": 5.1441309452056885,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u8ba1\u7b97\u6bcf\u4e2a\u4ea7\u54c1\u7c7b\u522b\u7684\u5e73\u5747\u4ef7\u683c\u548c\u5e93\u5b58\u603b\u91cf",
    "query_type": "aggregate",
    "difficulty": "complex",
    "gold_query": "db.products.aggregate([\n            {\"$group\": {\n                \"_id\": \"$category\",\n                \"avg_price\": {\"$avg\": \"$price\"},\n                \"total_stock\": {\"$sum\": \"$stock\"}\n            }}\n        ])",
    "pred_query": "db.products.aggregate([\n    {\"$unwind\": \"$items\"},\n    {\"$group\": {\n        \"_id\": \"$category\",\n        \"average_price\": {\"$avg\": \"$price\"},\n        \"total_stock\": {\"$sum\": \"$stock\"}\n    }}\n])",
    "execution_match": false,
    "gold_result": [
      {
        "_id": "Furniture",
        "avg_price": 298.6566666666667,
        "total_stock": 125
      },
      {
        "_id": "Electronics",
        "avg_price": 379.99,
        "total_stock": 575
      }
    ],
    "pred_result": [],
    "error": null,
    "latency": 1.8637011051177979,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u627e\u51fa\u6700\u8fd1\u4e00\u5468\u5185\u5b8c\u6210\u7684\u8ba2\u5355",
    "query_type": "find",
    "difficulty": "complex",
    "gold_query": "db.orders.find({\n            \"status\": \"completed\",\n            \"created_at\": {\"$gte\": new Date(new Date().setDate(new Date().getDate() - 7))}\n        })",
    "pred_query": "from pymongo import MongoClient, DESCENDING\n\n# Establish a connection to MongoDB\nclient = MongoClient('mongodb://localhost:27017/')\ndb = client['your_database_name']\n\n# Define the date one week ago from today\none_week_ago = datetime.datetime.utcnow() - datetime.timedelta(weeks=1)\n\n# Query for orders completed in the last week\nquery = {\n    \"created_at\": {\"$gte\": one_week_ago}\n}\n\n# Execute the query and retrieve the results\norders = db.orders.find(query).sort(\"created_at\", DESCENDING)\n\n# Print the results\nfor order in orders:\n    print(order)",
    "execution_match": false,
    "gold_result": null,
    "pred_result": null,
    "error": "invalid syntax (<string>, line 1)",
    "latency": 3.897275924682617,
    "model": "ollama:qwen2.5-coder:7b"
  },
  {
    "question": "\u66f4\u65b0\u6240\u6709\u85aa\u8d44\u4f4e\u4e8e60000\u7684\u5458\u5de5\uff0c\u589e\u52a010%",
    "query_type": "update",
    "difficulty": "complex",
    "gold_query": "db.users.update_many(\n            {\"salary\": {\"$lt\": 60000}},\n            {\"$mul\": {\"salary\": 1.1}}\n        )",
    "pred_query": "db.users.update_many(\n    {\"salary\": {\"$lt\": 60000}},\n    {\"$mul\": {\"salary\": 1.1}}\n)",
    "execution_match": false,
    "gold_result": {
      "matched": 2,
      "modified": 2
    },
    "pred_result": {
      "matched": 0,
      "modified": 0
    },
    "error": null,
    "latency": 1.3843400478363037,
    "model": "ollama:qwen2.5-coder:7b"
  }
]